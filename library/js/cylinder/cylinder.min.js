/*
 * cylinder v0.11.1 (2016-05-13 15:13:49)
 * @author Lu√≠s Soares <luis.soares@comon.pt>
 */

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){var a=this,b=!1;this.version="0.11.1",this.initialized=function(){return b},this.dependency=function(){var a=arguments,b=!_.isBoolean(_.last(a));b||(a=_.initial(a));for(var c=0;c<a.length;c++)for(var d=a[c],e="object"==typeof d,f=!e||1!=d.optional,g=e?d.scope||window:window,h=e?d.name:d,i=(""+(e?d["package"]:d)).split("."),j=0;j<i.length;j++){var d=i[j],k=Object.prototype.hasOwnProperty.call(g,d);if(!k){if(b&&f)throw new CylinderException('Missing dependency "'+h+'"!');return!1}g=g[d]}return!0},this.dependency("async","jQuery",{"package":"_",name:"underscore.js"},{"package":"s",name:"underscore.string"},"Backbone");var c=[],d={};this.$=jQuery,this._=_,this.s=s,_.extend(_,{str:this.s}),_.extend(this,Backbone.Events),this.extend=function(d,e){return!b&&e?(_.contains(c,d)||c.push(d),a):("function"==typeof d&&(d=d(a)),arguments.length<3&&a.trigger("extend",d),_.extend(a,d),d)},this.module=function(c,e){if(!_.isString(c)||/^\s*$/.test(c))throw new CylinderException("Trying to add a nameless module!");if(_.isUndefined(e)||_.isNull(e))return b&&_.has(d,c)?a[c]:null;if(d[c]=e,!b)return a;var f={},g={},h=f[c]="function"==typeof e?e(a,g):_.extend(g,e);return a.extend(f,!0,!1),a.trigger("module",c,h),f},this.modules=function(){return _.mapObject(d,function(b,c){return a[c]})},this.init=function(e){return b?a:(b=!0,a.$(function(){_.each(c,function(b){a.extend(b)}),_.each(d,function(b,c){a.module(c,b)}),_.isFunction(e)&&e(a),a.trigger("init",a)}),a)}}b.exports=d},{}],2:[function(a,b,c){function d(a,b){this.value=b,this.message=null!=a?a.toString():a,this.toString=function(){return this.message}}b.exports=d},{}],3:[function(a,b,c){b.exports=function(a){var b=!1,c={};return a.controller=function(d,e){if(!_.isString(d)||a.s.isBlank(d))throw new CylinderException("Trying to add a nameless controller!");return _.isUndefined(e)||_.isNull(e)?b&&_.has(c,d)?c[d].instance:null:(c[d]={constructor:e,instance:{}},b?(c[d].instance="function"==typeof e?e(a,c[d].instance):_.extend(c[d].instance,e),a.trigger("controller",d,c[d].instance),c[d].instance):c[d].instance)},a.controllers=function(){return _.mapObject(c,function(a,b){return a.instance})},a.initControllers=function(d){return b?a:(b=!0,a.$(function(){_.each(c,function(b,c){a.controller(c,b.constructor)}),_.isFunction(d)&&d(a),a.trigger("initcontrollers",a)}),a)},a}},{}],4:[function(a,b,c){!function(b){b.CylinderClass=a("./core/class"),b.CylinderException=a("./core/exception"),b.CylinderClass.ExtensionControllers=a("./extensions/controllers"),b.CylinderClass.ModuleUtils=a("./modules/utils"),b.CylinderClass.ModuleDom=a("./modules/dom"),b.CylinderClass.ModuleStore=a("./modules/store"),b.CylinderClass.ModuleAnalytics=a("./modules/analytics"),b.CylinderClass.ModuleTemplates=a("./modules/templates"),b.CylinderClass.ModuleRouter=a("./modules/router"),b.CylinderClass.ModuleResize=a("./modules/resize"),b.CylinderClass.ModuleScroll=a("./modules/scroll"),b.Cylinder=b.cylinder=new CylinderClass,b.Cylinder.extend(b.CylinderClass.ExtensionControllers),b.Cylinder.module("utils",b.CylinderClass.ModuleUtils),b.Cylinder.module("dom",b.CylinderClass.ModuleDom),b.Cylinder.module("store",b.CylinderClass.ModuleStore),b.Cylinder.module("analytics",b.CylinderClass.ModuleAnalytics),b.Cylinder.module("templates",b.CylinderClass.ModuleTemplates),b.Cylinder.module("router",b.CylinderClass.ModuleRouter),b.Cylinder.module("resize",b.CylinderClass.ModuleResize),b.Cylinder.module("scroll",b.CylinderClass.ModuleScroll)}(window)},{"./core/class":1,"./core/exception":2,"./extensions/controllers":3,"./modules/analytics":5,"./modules/dom":6,"./modules/resize":7,"./modules/router":8,"./modules/scroll":9,"./modules/store":10,"./modules/templates":11,"./modules/utils":12}],5:[function(require,module,exports){module.exports=function(cylinder,_module){function call_ga(args){if("undefined"==typeof ga||_.isNull(ga)||!_.isFunction(ga))return null;var s="'"+args.join("','")+"'";return module.options.debug?"ga("+s+")":eval("ga("+s+")")}function call_gaq(a){if("undefined"==typeof _gaq||_.isNull(_gaq))return null;var b="'"+a.join("','")+"'";return module.options.debug?"_gaq.push(["+b+"])":_gaq.push(a)}var module=_.extend({},_module);return module.options={debug:!1,log:!1},module.pageview=function(a){module.options.log&&!_.isUndefined(console.log)&&console.log("Pageview: "+a),call_ga(["send","pageview",a]),call_gaq(["_trackEvent",a])},module.event=function(a,b,c,d){module.options.log&&!_.isUndefined(console.log)&&console.log("Event: "+a+" "+b+" "+c+" "+d);var e=_.toArray(arguments);call_ga(_.union(["send","event"],e)),call_gaq(_.union(["_trackEvent"],e))},module}},{}],6:[function(a,b,c){b.exports=function(a,b){var c=_.extend({},b);return a.dependency("Cylinder.utils"),c.options={title:"Cylinder"},c.$window=a.$(window),c.$document=a.$(document),c.$html=c.$document.find("html"),c.$head=c.$document.find("head"),c.$body=c.$document.find("body"),c.title=function(b,d){var e=!a.s.isBlank(b),f=(e?" - ":"")+c.options.title;d&&e&&(f=""),e||(b=""),document.title=a.s.unescapeHTML(b+f)},c.meta=function(a){if(!_.isObject(a)){if(arguments.length<2)return;a={},a[arguments[0]]=arguments[1]}_.each(a,function(a,b){var d=c.$head.find('meta[name="'+b+'"], meta[property="'+b+'"]');return d.length<1?void console.warn('CYLINDER.DOM: tried to change meta "'+b+"\" but it doesn't exist"):void d.attr("content",a)})},c}},{}],7:[function(a,b,c){!function(a){a.viewportSize={},a.viewportSize.getHeight=function(){return b("Height")},a.viewportSize.getWidth=function(){return b("Width")};var b=function(b){var c,d,e,f=b.toLowerCase(),g=a.document,h=g.documentElement;return void 0===a["inner"+b]?c=h["client"+b]:a["inner"+b]!=h["client"+b]?(d=g.createElement("body"),d.id="vpw-test-b",d.style.cssText="overflow:scroll",e=g.createElement("div"),e.id="vpw-test-d",e.style.cssText="position:absolute;top:-1000px",e.innerHTML="<style>@media("+f+":"+h["client"+b]+"px){body#vpw-test-b div#vpw-test-d{"+f+":7px!important}}</style>",d.appendChild(e),h.insertBefore(d,g.head),c=7==e["offset"+b]?h["client"+b]:a["inner"+b],h.removeChild(d)):c=a["inner"+b],c}}(window),b.exports=function(a,b){function c(a){var b=_.extend({name:null,width_min:null,width_max:null,height_min:null,height_max:null,callback:_.noop},a);return b.toString=function(){return JSON.stringify(b)},b}function d(a,b,c){return a>=c.width&&(_.isNumber(c.width_max)?a<=c.width_max:!0)}function e(b){f.previous_width=f.width,f.previous_height=f.height,f.width=viewportSize.getWidth(),f.height=viewportSize.getHeight(),_.each(g,function(b,e){b instanceof c&&a.dom.$body.toggleClass(e,(_.isFunction(b.callback)?b.callback:d)(f.width,f.height,b))}),b&&f.trigger()}var f=_.extend({},b);a.dependency("Cylinder.dom"),f.done=!1,f.width=0,f.height=0,f.previous_width=0,f.previous_height=0;var g={"layout-xs":new c({width_min:0,width_max:767}),"layout-sm":new c({width_min:768,width_max:991}),"layout-md":new c({width_min:992,width_max:1199}),"layout-lg":new c({width_min:1200})};return f.addRule=function(a,b){g[a]=b},f.removeRule=function(a){delete g[a]},f.rules=function(){return g},f.trigger=function(){a.trigger("resize",f.width,f.height),f.done=!0},a.dom.$window.on("resize",function(a){e(!0)}),e(!1),f}},{}],8:[function(a,b,c){b.exports=function(a,b){function c(a,b,c,d){return g.length<1?d():async.eachSeries(g,function(d,e){_.isFunction(d)?d.apply(a,[function(){e()},b.name,c]):e()},function(a){return d()})}function d(a,b,c,d){return b.middleware.length<1?d():async.eachSeries(b.middleware,function(b,d){_.isFunction(b)?b.apply(a,[function(){d()}].concat(c)):d()},function(a){return d()})}var e=_.extend({},b);e.options={push:!1,clicks:!0,prefix:"",selector:"a:not([data-bypass])",navigate_defaults:{trigger:!0}},e.done=!1,e.url=null,e.route=null,e.previous_url=null,e.previous_route=null;var f={},g=[],h="",i="",j="",k=Backbone.Router.extend({execute:function(b,g,h){var j=f[h],k=this;return g=_.initial(g),c(k,j,g,function(){return d(k,j,g,function(){e.previous_route=e.route,e.route=h,e.previous_url=e.url,e.url=e.options.push?Backbone.history.location.pathname.replace(i,""):Backbone.history.location.hash.replace("!","").replace("#",""),a.trigger("route",h,g),e.done=!0,b&&b.apply(k,g)})})}}),l=new k,m=null;return e.reload=function(a){return m=clearTimeout(m),_.isNumber(a)&&a>0?m=setTimeout(function(){e.reload()},a):window.location.reload()},e.setup=function(b,c){if(_.isString(b)||(b=h),_.isString(c)||(c=i),!a.s.isBlank(b)){var d=b.replace("//","||").indexOf("/");if(d<b.length){var f=b.slice(d+1);b=b.replace(f,""),c=f+c}}h=(a.s.isBlank(b)?location.protocol+"//"+location.host:a.s.trim(b,"/"))+"/",i=(a.s.isBlank(c)?"":"/"+a.s.trim(c,"/")).replace(h,"")+"/",j=a.s.rtrim(h,"/")+"/"+a.s.ltrim(i,"/"),Backbone.History.started&&e.start(!0)},e.domain=function(){return h},e.root=function(){return i},e.path=function(){return j},e.start=function(a){e.stop(),Backbone.history.start({pushState:e.options.push,root:i,silent:a||!1})},e.stop=function(){Backbone.History.started&&Backbone.history.stop()},e.go=function(a,b,c){return Backbone.History.started?void Backbone.history.navigate((c!==!1?e.options.prefix:"")+a,_.extend({},e.options.navigate_defaults,b)):void(e.options.push?window.location=j+a:window.location.hash="#"+a)},e.add=function(){var b=_.flatten(arguments),c=_.isString(b[0])&&!a.s.isBlank(b[0])?b[0]:!1,d=_.isString(b[1])&&!a.s.isBlank(b[1])?b[1]:b[0];if(a.s.isBlank(d))throw new CylinderException("Trying to add a handler to router but no valid syntax provided.");c=a.s.slugify(c);var g=e.options.prefix||"";!a.s.isBlank(g)&&a.s.endsWith(g,"/")&&(a.s.startsWith(d,"/")||a.s.startsWith(d,"(/)"))&&(g=g.slice(0,g.length-1));var h=_.filter(arguments,_.isFunction),i=_.last(h),j=_.initial(h),k={name:c,syntax:d,callback:i,middleware:j};return f[c]=k,l.route(g+d,c,i)},e.use=function(a){g.push(a)},e.unuse=function(a){g=_.without(g,a)},e.addHandler=function(b){var c=_.last(_.flatten(arguments));_.isFunction(c)||(c=null),a.dom.$document.on("click.clrouter",_.isString(b)&&!a.s.isBlank(b)?b:e.options.selector,function(b){if(e.options.clicks){var d=a.$(this),f={attr:d.attr("href"),prop:d.prop("href"),target:d.prop("target")};if(a.s.isBlank(f.target)||"_self"==f.target)return"#"==f.attr&&e.options.push?b.preventDefault():void(f.prop&&f.prop.slice(0,j.length)===j&&-1!==f.prop.indexOf(e.options.prefix)&&(b.preventDefault(),e.go(f.prop.replace(j,"")),_.isFunction(c)&&c(d,f)))}})},e.removeHandler=function(b){a.dom.$document.off("click.clrouter",_.isString(b)&&!a.s.isBlank(b)?b:e.options.selector)},e.setup("",a.$(location).attr("pathname")),e}},{}],9:[function(a,b,c){b.exports=function(a,b){a.dependency("Cylinder.dom");var c=function(b,c){function d(b){return j&&null!=a.resize?a.resize.width:b.prop("clientWidth")||0}function e(b){return j&&null!=a.resize?a.resize.height:b.prop("clientHeight")||0}function f(a,b){h.previous_left=h.left,h.previous_top=h.top,h.previous_right=h.right,h.previous_bottom=h.bottom,h.left=h.$el.scrollLeft(),h.top=h.$el.scrollTop(),h.right=h.left+d(h.$el),h.bottom=h.top+e(h.$el),a&&g(b)}function g(b){h.trigger("scroll",h.$el,h.left,h.top,b),a.trigger("scroll:"+i,h.$el,h.left,h.top,b),a.trigger("scroll",h.$el,h.left,h.top,b),h.done=!0}var h=_.extend({},Backbone.Events);h.$el=b instanceof a.$&&b.length>0?b:a.dom.$window;var i=a.s.isBlank(c)?a.s.slugify(h.$el.attr("class")||h.$el.prop("nodeName")||"window"):c,j=h.$el.is(a.dom.$window),k=h.$el.is(a.dom.$html),l=h.$el.is(a.dom.$body);return h.done=!1,h.left=0,h.top=0,h.right=0,h.bottom=0,h.previous_left=0,h.previous_top=0,h.previous_right=0,h.previous_bottom=0,h.go=function(b,c,d){if(b instanceof jQuery){var e=b;if(0==e.length||!a.$.contains((j||k?a.dom.$body:h.$el)[0],e[0]))return;d=c;var f=e.offset()||{left:0,top:0},g=j?a.dom.$html:h.$el,i=g[0];b=Math.min(i.scrollWidth-g.prop("clientWidth"),f.left),c=Math.min(i.scrollHeight-g.prop("clientHeight"),f.top)}var m=b>=0,n=c>=0;if(m||n){if(a.s.isBlank(d)||!_.isNumber(d)||1>d)return m&&h.$el.scrollLeft(b),void(n&&h.$el.scrollTop(c));if($.velocity)m&&b!=h.left&&h.$el.velocity("scroll",{duration:d,offset:b,mobileHA:!1,axis:"x",queue:!1}),n&&c!=h.top&&h.$el.velocity("scroll",{duration:d,offset:c,mobileHA:!1,axis:"y",queue:!1});else{var o={};m&&(o.scrollLeft=b),n&&(o.scrollTop=c),j||k||l?(a.dom.$html.animate(o,d),a.dom.$body.animate(o,d)):h.$el.animate(o,d)}}},h.$el.off("scroll.cylinder").on("scroll.cylinder",function(a){f(!0,a)}),f(!1,null),h};return _.extend(c(a.dom.$window),{initialize:c})}},{}],10:[function(a,b,c){b.exports=function(a,b){var c=_.extend({},b),d={},e=null,f=null;return c.Model=Backbone.Model.extend({initialize:function(){this.on("change",function(){return this.save()},this)},sync:function(){},fetch:function(){},save:function(){},destroy:function(){}}),c.use=function(a,b){var e=null;if(b instanceof Backbone.Model)e=b;else if(b.constructor===Backbone.Model.constructor)e=new b;else if(!_.isEmpty(b)){var f=c.Model.extend(b);e=new f}return d[a]=e,e},c.unuse=function(a){if(!_.has(d,a)){if(exception!==!1)throw new CylinderException("Trying to remove a non-existing or invalid model from store.");return null}if(a===f){if(exception!==!1)throw new CylinderException("Trying to remove the currently used data model from store. Switch to another model first.");return null}var b=d[a];return delete d[a],b},c.models=function(){return _.mapObject(d,function(a,b){return a})},c["with"]=function(a,b){if(!_.has(d,a)){if(b!==!1)throw new CylinderException("Trying to get non-existing or invalid model from store.");return null}return d[a]},c["switch"]=function(a){var b=c["with"](a,!1);if(!b)throw new CylinderException("Trying to switch store context to non-existing or invalid model.");return c.fetch=_.bind(b.fetch,b),c.save=_.bind(b.save,b),c.destroy=_.bind(b.destroy,b),c.get=_.bind(b.get,b),c.escape=_.bind(b.escape,b),c.set=_.bind(b.set,b),c.has=_.bind(b.has,b),c.unset=_.bind(b.unset,b),c.clear=_.bind(b.clear,b),c.toJSON=_.bind(b.toJSON,b),e=b,f=a,b},c.use("localstorage",{namespace:"cylinder_data",fetch:function(){var b=this,c=a.$.Deferred();if(a.dependency("localStorage",!1)){var d=JSON.parse(localStorage.getItem(b.namespace));b.set(d),c.resolve(d)}else c.reject();return c},save:function(){var b=this,c=a.$.Deferred();if(a.dependency("localStorage",!1)){var d=b.toJSON();localStorage.removeItem(b.namespace),localStorage.setItem(b.namespace,JSON.stringify(d)),c.resolve(d)}else c.reject();return c}}),c["switch"]("localstorage"),c}},{}],11:[function(require,module,exports){module.exports=function(cylinder,_module){function getElementFromVariable(a){return a instanceof cylinder.$?a:_.isString(a)&&!cylinder.s.isBlank(a)||null!=a&&(a.tagName||a.nodeName)?cylinder.$(a):null}var module=_.extend({},_module);cylinder.dependency("Mustache");var add_counter=0,replace_counter=0,cache_templates={},cache_partials={},cache_replaced={},load_jobs={},load_errored={};if(module.options={load:!1,load_cache:!1,load_base_path:"tpl/",load_extension:".mustache",fire_events:!0,partials:!0,premades:"JST"},module.defaults={},module.has=function(a){return _.has(cache_templates,a)},module.add=function(a,b,c,d){var e={id:a||"temp"+add_counter,defaults:_.isObject(c)?c:{},partials:_.isObject(d)?d:{},html:(_.isString(b)?b:"").replace(/<javascript/gi,'<script type="text/javascript"').replace(/<\/javascript>/gi,"</script>")};return Mustache.parse(e.html),cache_templates[a]=e,add_counter++,module.options.partials&&(cache_partials=_.object(_.keys(cache_templates),_.pluck(cache_templates,"html"))),e},module.get=function(id){if(module.has(id))return cache_templates[id];var template_name=cylinder.s.replaceAll(id,"/","_"),$template=cylinder.$("#template_"+template_name);if($template.length>0){var d={};try{d=eval("("+$template.attr("data-defaults")+")")}catch(e){}var template=module.add(id,cylinder.s.trim($template.html()),d);return $template.remove(),template}return{}},module.load=function(){var a=cylinder.$.Deferred(),b=_.chain(arguments).flatten().filter(function(a){return _.isString(a)&&!cylinder.s.isBlank(a)}).value();if(b.length>1)return async.each(b,function(a,b){module.load(a).done(function(a){b(null,a)}).fail(function(a){b(a)})},function(b,c){b?a.reject(b):a.resolve()}),a;var c=_.first(b);if(_.has(load_errored,c))return a.reject(load_errored[c]),a;if(_.has(load_jobs,c))return load_jobs[c].promises.push(a),a;var d=module.get(c);if(!_.isEmpty(d))return a.resolve(d),a;var e=module.options.load_base_path;cylinder.s.endsWith(e,"/")||(e+="/");var f=c,g=f.split("/"),h=_.last(g);cylinder.s.include(h,module.options.load_extension)||(f+=module.options.load_extension);var i={id:c,path:e+f,date:new Date,request:null,promises:[a]};return i.request=$.ajax({url:i.path,cache:module.options.load_cache,method:"get",dataType:"html",error:function(a,b,d){delete load_jobs[c];var e={jxhr:a,text:b,thrown:d,status:a.status};load_errored[c]=e,_.each(i.promises,function(a){a.reject(e)})},success:function(a){delete load_jobs[c],d=module.add(c,a),_.each(i.promises,function(a){a.resolve(d)})}}),load_jobs[c]=i,a},module.render=function(a,b,c){var d=module.get(a),e=Mustache.render(d.html||'!! Template "'+a+'" not found !!',_.extend({},module.defaults,d.defaults,b),_.extend({},cache_partials,d.partials,c));if(module.options.fire_events){var f=a.split("/");cylinder.trigger("render",a,b,c),_.reduce(f,function(a,d){return a=cylinder.s.trim(a+"/"+d,"/"),cylinder.trigger("render:"+a,b,c),a},"")}return e},module.apply=function(a,b,c,d){var e=cylinder.$.Deferred();if(a=getElementFromVariable(a),null===a||0==a.length)throw new CylinderException("Trying to apply a template to an empty or unknown jQuery element.");var f=function(){if(module.options.fire_events){var e=b.split("/");_.reduce(e,function(e,f){return e=cylinder.s.trim(e+"/"+f,"/"),cylinder.trigger("apply:"+e,a,b,c,d),e},""),cylinder.trigger("apply",a,b,c,d)}};return module.options.load?module.load(b).fail(function(a){e.reject(a)}).done(function(){a.html(module.render(b,c,d)),e.resolve(a,b,c,d),f()}):(a.html(module.render(b,c,d)),e.resolve(a,b,c,d),f()),e.promise()},module.replace=function(a,b,c){var d=cylinder.$.Deferred();if(a=getElementFromVariable(a),null===a||0==a.length)throw new CylinderException("Trying to replace contents on an empty or unknown jQuery element.");var e=function(){module.options.fire_events&&cylinder.trigger("replace",a,b,c)},f="",g=a.data("template-id");!_.str.isBlank(g)&&_.has(cache_replaced,g)?f=cache_replaced[g]:(g=""+(new Date).getTime()+replace_counter,a.data("template-id",g),f=cylinder.s.unescapeHTML(a.html()),cache_replaced[g]=f,replace_counter++);var h=Mustache.render(f,_.extend({},module.defaults,b),_.extend({},cache_partials,c));return a.html(h),d.resolve(a,b,c),e(),d.promise()},module.options.premades!==!1){var variable=_.isString(module.options.premades)?module.options.premades:"JST";_.each(_.isObject(window[variable])?window[variable]:{},function(a,b){module.add(b,_.isFunction(a)?a():a)})}return module}},{}],12:[function(a,b,c){b.exports=function(a,b){var c=_.extend({},b);return c.text=function(b){return a.$("<div>").html(b).text()},c.unserialize=function(a){for(var b,c,d=decodeURI(a),e=d.split("&"),f=/\+/g,g={},h=0,i=e.length;i>h;h++)b=e[h].split("="),c=b[0],void 0===g[c]?g[c]=decodeURIComponent(b[1]).replace(f," "):("string"==typeof g[c]&&(g[c]=[g[c]]),g[c].push(decodeURIComponent(b[1]).replace(f," ")));return g},c.query=function(a,b){var d=b||window.location.search.substring(1),e=c.unserialize(d);return _.has(e,a)?e[a]:null},c}},{}]},{},[4]);
//# sourceMappingURL=cylinder.min.js.map